!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("engine",[],e):"object"==typeof exports?exports.engine=e():t.engine=e()}(this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/lib/",e(e.s=19)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=(e.library="lowww WebGL engine",e.version="0.0.1",e.env="build",void 0);e.setContext=function(t){a=t},e.getContext=function(){return a}},function(t,e){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var a=Math.PI/180;n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=n},function(t,e,n){e.glMatrix=n(1),e.mat2=n(21),e.mat2d=n(22),e.mat3=n(12),e.mat4=n(23),e.quat=n(24),e.vec2=n(25),e.vec3=n(13),e.vec4=n(14)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BASIC_MATERIAL=100,e.FLATSHADING_MATERIAL=101,e.SEM_MATERIAL=102,e.RAW_MATERIAL=103,e.AMBIENT_LIGHT=200,e.DIRECTIONAL_LIGHT=201,e.POINT_LIGHT=202,e.MAX_DIRECTIONAL=2},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(2),i=n(29),u=function(t){return t&&t.__esModule?t:{default:t}}(i),l=0,s=0,c=o.vec3.create(),f=function(){function t(){a(this,t),this.uid=l++,this.position=new u.default,this.rotation=new u.default,this.scale=new u.default(1,1,1),this.quaternion=o.quat.create(),this.parent=null,this.children=[],this.parentMatrix=o.mat4.create(),this.modelMatrix=o.mat4.create()}return r(t,[{key:"addModel",value:function(t){t.parent=this,this.children.push(t)}},{key:"removeModel",value:function(t){var e=this.children.indexOf(t);-1!==e&&(t.destroy(),this.children.splice(e,1))}},{key:"updateMatrices",value:function(){o.mat4.identity(this.parentMatrix),o.mat4.identity(this.modelMatrix),o.quat.identity(this.quaternion),this.parent&&(o.mat4.copy(this.parentMatrix,this.parent.modelMatrix),o.mat4.multiply(this.modelMatrix,this.modelMatrix,this.parentMatrix)),o.mat4.translate(this.modelMatrix,this.modelMatrix,this.position.data),o.quat.rotateX(this.quaternion,this.quaternion,this.rotation.x),o.quat.rotateY(this.quaternion,this.quaternion,this.rotation.y),o.quat.rotateZ(this.quaternion,this.quaternion,this.rotation.z),s=o.quat.getAxisAngle(c,this.quaternion),o.mat4.rotate(this.modelMatrix,this.modelMatrix,s,c),o.mat4.scale(this.modelMatrix,this.modelMatrix,this.scale.data)}}]),t}();e.default=f},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(0),i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t);var n=(0,o.getContext)();Object.assign(this,{magFilter:n.NEAREST,minFilter:n.NEAREST,wrapS:n.CLAMP_TO_EDGE,wrapT:n.CLAMP_TO_EDGE},e);var r=new Uint8Array([0,0,0,255]);this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,this.magFilter),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.minFilter),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this.wrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this.wrapT),n.bindTexture(n.TEXTURE_2D,null)}return r(t,[{key:"fromImage",value:function(t){var e=this,n=new Image;n.crossOrigin="",n.onload=function(){e.update(n)},n.src=t}},{key:"update",value:function(t){var e=(0,o.getContext)();e.bindTexture(e.TEXTURE_2D,this.texture),e.generateMipmap(e.TEXTURE_2D),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null)}}]),t}();e.default=i},function(t,e,n){"use strict";function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.color=e.math=e.geometry=void 0;var r=n(8),o=a(r),i=n(17),u=a(i),l=n(33),s=a(l);e.geometry=o,e.math=u,e.color=s},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(34),i=function(t){return t&&t.__esModule?t:{default:t}}(o),u=n(35),l=n(0),s={},c=function(){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(this,t),this.defines={},this.attributes=Object.assign({a_position:{type:"vec3",value:null},a_normal:{type:"vec3",value:null},a_uv:{type:"vec2",value:null}}),this.uniforms={},this.vertex="",this.fragment="",this.vao=new i.default,this.program=null,this.indices=null}return r(t,[{key:"createProgram",value:function(){var t=(0,l.getContext)(),e="shader-"+this.type;if(void 0===s[e]){var n=(0,u.createProgram)(t,this.vertex,this.fragment);s[e]=n}this.program=s[e]}},{key:"initAttributes",value:function(){var t=(0,l.getContext)();for(var e in this.attributes){var n=this.attributes[e],a=t.getAttribLocation(this.program,e),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,n.value,t.STATIC_DRAW);var o=void 0;switch(n.type){case"vec3":o=3;break;case"vec2":o=2;break;default:o=1}Object.assign(n,{location:a,buffer:r,size:o})}this.indices&&(this.indexBuffer=t.createBuffer())}},{key:"initUniforms",value:function(){var t=this,e=(0,l.getContext)(),n=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5];Object.keys(this.uniforms).forEach(function(a,r){var o=t.uniforms[a],i=e.getUniformLocation(t.program,a);"sampler2D"===o.type&&(o.textureIndex=r,o.activeTexture=n[r]),o.location=i})}},{key:"init",value:function(){this.createProgram(),this.initAttributes(),this.initUniforms(),this.vao.bind(),this.bind(),this.vao.unbind(),this.unbind()}},{key:"destroy",value:function(){}},{key:"bind",value:function(){var t=this,e=(0,l.getContext)();Object.keys(this.attributes).forEach(function(n){var a=t.attributes[n],r=a.location,o=a.buffer,i=a.size;-1!==r&&(e.enableVertexAttribArray(r),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(r,i,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,null))}),this.indices&&(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW))}},{key:"unbind",value:function(){var t=(0,l.getContext)();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},{key:"update",value:function(){var t=this,e=(0,l.getContext)();Object.keys(this.uniforms).forEach(function(n){var a=t.uniforms[n];switch(a.type){case"mat4":e.uniformMatrix4fv(a.location,!1,a.value);break;case"mat3":e.uniformMatrix3fv(a.location,!1,a.value);break;case"vec4":e.uniform4fv(a.location,a.value);break;case"vec3":e.uniform3fv(a.location,a.value);break;case"vec2":e.uniform2fv(a.location,a.value);break;case"float":e.uniform1f(a.location,a.value);break;case"sampler2D":e.uniform1i(a.location,a.textureIndex),e.activeTexture(a.activeTexture),e.bindTexture(e.TEXTURE_2D,a.value);break;default:console.warn("unknown uniform type",a.type)}})}}]),t}();e.default=c},function(t,e,n){"use strict";function a(t){for(var e=[],n=0;n<t.length;n++)Array.isArray(t[n])||t[n]instanceof Float32Array?e=e.concat(a(t[n])):e.push(t[n]);return e}function r(t,e){for(var n=[],a=0;a<t.length;a+=e){for(var r=[],o=0;o<e;o++)r.push(t[a+o]);n.push(r)}return n}function o(t,e){for(var n=r(e,3),o=r(t,3),i=[],l=u.vec3.create(),s=u.vec3.create(),c=u.vec3.create(),f=void 0,h=void 0,M=void 0,d=0;d<n.length;d++){var v=n[d],m=v[0],p=v[1],x=v[2];f=o[m],h=o[p],M=o[x],u.vec3.subtract(l,M,h),u.vec3.subtract(s,f,h),u.vec3.cross(c,l,s),void 0===i[m]&&(i[m]=u.vec3.create()),void 0===i[p]&&(i[p]=u.vec3.create()),void 0===i[x]&&(i[x]=u.vec3.create()),u.vec3.add(i[m],i[m],c),u.vec3.add(i[p],i[p],c),u.vec3.add(i[x],i[x],c)}for(var b=0;b<i.length;b++)u.vec3.normalize(i[b],i[b]);return a(i,3)}function i(t){for(var e=r(t.positions,3),n={},i=[],u=[],l=Math.pow(10,4),s=0;s<e.length;s++){var c=e[s],f="\n            "+Math.round(c[0]*l)+"_\n            "+Math.round(c[1]*l)+"_\n            "+Math.round(c[2]*l)+"\n        ";void 0===n[f]?(n[f]=s,i.push(e[s]),u[s]=i.length-1):u[s]=u[n[f]]}for(var h=[],M=r(t.indices,3),d=0;d<M.length;d++){var v=M[d];v[0]=u[v[0]],v[1]=u[v[1]],v[2]=u[v[2]];for(var m=[v[0],v[1],v[2]],p=0;p<3;p++)if(m[p]===m[(p+1)%3]){h.push(d);break}}for(var x=h.length-1;x>=0;x--){var b=h[x];M.splice(b,1);for(var I=0;I<this.faceVertexUvs.length;I++)this.faceVertexUvs[I].splice(b,1)}var S=a(i,3),D=a(M,3);return{positions:new Float32Array(S),indices:new Uint16Array(D),normals:new Float32Array(o(S,D))}}Object.defineProperty(e,"__esModule",{value:!0}),e.flatten=a,e.unflatten=r,e.generateVertexNormals=o,e.mergeVertices=i;var u=n(2)},function(t,e,n){"use strict";function a(){return"\n    float fogStart = fogSettings.x;\n    float fogEnd = fogSettings.y;\n    float fogDensity = fogSettings.z;\n\n    float dist = 0.0;\n    float fogFactor = 0.0;\n    dist = gl_FragCoord.z / gl_FragCoord.w;"}function r(){return a()+"\n\n    fogFactor = (fogEnd - dist) / (fogEnd - fogStart);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    base = mix(fogColor, base, fogFactor);"}function o(){return a()+"\n    fogFactor = 1.0 / exp(dist * fogDensity);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    base = mix(fogColor, base, fogFactor);"}function i(){return a()+"\n    fogFactor = 1.0 /exp( (dist * fogDensity) * (dist * fogDensity) );\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    base = mix(fogColor, base, fogFactor);"}Object.defineProperty(e,"__esModule",{value:!0}),e.linear=r,e.exponential=o,e.exponential2=i},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=function(){function t(){a(this,t)}return r(t,null,[{key:"load",value:function(t){return new Promise(function(e,n){var a=new XMLHttpRequest;a.open("GET",t),a.onload=function(){200===a.status?e(a.response):n(Error(a.statusText))},a.onerror=function(){n(Error("Network Error"))},a.send()})}}]),t}();e.default=o},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var a=n(1),r={};r.create=function(){var t=new a.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new a.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,n,r,o,i,u,l,s){var c=new a.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=o,c[5]=i,c[6]=u,c[7]=l,c[8]=s,c},r.set=function(t,e,n,a,r,o,i,u,l,s){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=a,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=c*i-u*s,h=-c*o+u*l,M=s*o-i*l,d=n*f+a*h+r*M;return d?(d=1/d,t[0]=f*d,t[1]=(-c*a+r*s)*d,t[2]=(u*a-r*i)*d,t[3]=h*d,t[4]=(c*n-r*l)*d,t[5]=(-u*n+r*o)*d,t[6]=M*d,t[7]=(-s*n+a*l)*d,t[8]=(i*n-a*o)*d,t):null},r.adjoint=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8];return t[0]=i*c-u*s,t[1]=r*s-a*c,t[2]=a*u-r*i,t[3]=u*l-o*c,t[4]=n*c-r*l,t[5]=r*o-n*u,t[6]=o*s-i*l,t[7]=a*l-n*s,t[8]=n*i-a*o,t},r.determinant=function(t){var e=t[0],n=t[1],a=t[2],r=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8];return e*(s*o-i*l)+n*(-s*r+i*u)+a*(l*r-o*u)},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=n[0],M=n[1],d=n[2],v=n[3],m=n[4],p=n[5],x=n[6],b=n[7],I=n[8];return t[0]=h*a+M*i+d*s,t[1]=h*r+M*u+d*c,t[2]=h*o+M*l+d*f,t[3]=v*a+m*i+p*s,t[4]=v*r+m*u+p*c,t[5]=v*o+m*l+p*f,t[6]=x*a+b*i+I*s,t[7]=x*r+b*u+I*c,t[8]=x*o+b*l+I*f,t},r.mul=r.multiply,r.translate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=n[0],M=n[1];return t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=h*a+M*i+s,t[7]=h*r+M*u+c,t[8]=h*o+M*l+f,t},r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=Math.sin(n),M=Math.cos(n);return t[0]=M*a+h*i,t[1]=M*r+h*u,t[2]=M*o+h*l,t[3]=M*i-h*a,t[4]=M*u-h*r,t[5]=M*l-h*o,t[6]=s,t[7]=c,t[8]=f,t},r.scale=function(t,e,n){var a=n[0],r=n[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n+n,u=a+a,l=r+r,s=n*i,c=a*i,f=a*u,h=r*i,M=r*u,d=r*l,v=o*i,m=o*u,p=o*l;return t[0]=1-f-d,t[3]=c-p,t[6]=h+m,t[1]=c+p,t[4]=1-s-d,t[7]=M-v,t[2]=h-m,t[5]=M+v,t[8]=1-s-f,t},r.normalFromMat4=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],M=e[11],d=e[12],v=e[13],m=e[14],p=e[15],x=n*u-a*i,b=n*l-r*i,I=n*s-o*i,S=a*l-r*u,D=a*s-o*u,y=r*s-o*l,F=c*v-f*d,g=c*m-h*d,_=c*p-M*d,E=f*m-h*v,w=f*p-M*v,O=h*p-M*m,R=x*O-b*w+I*E+S*_-D*g+y*F;return R?(R=1/R,t[0]=(u*O-l*w+s*E)*R,t[1]=(l*_-i*O-s*g)*R,t[2]=(i*w-u*_+s*F)*R,t[3]=(r*w-a*O-o*E)*R,t[4]=(n*O-r*_+o*g)*R,t[5]=(a*_-n*w-o*F)*R,t[6]=(v*y-m*D+p*S)*R,t[7]=(m*I-d*y-p*b)*R,t[8]=(d*D-v*I+p*x)*R,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],h=e[0],M=e[1],d=e[2],v=e[3],m=e[4],p=e[5],x=t[6],b=e[7],I=e[8];return Math.abs(n-h)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-M)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(o-d)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-v)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(u-m)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(l-p)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(s-x)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(c-b)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-I)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))},t.exports=r},function(t,e,n){var a=n(1),r={};r.create=function(){var t=new a.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,n){var r=new a.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,n,a){return t[0]=e,t[1]=n,t[2]=a,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+a*a+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return n*n+a*a+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],a=t[2];return Math.sqrt(e*e+n*n+a*a)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],a=t[2];return e*e+n*n+a*a},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=e[2],o=n*n+a*a+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],l=n[2];return t[0]=r*l-o*u,t[1]=o*i-a*l,t[2]=a*u-r*i,t},r.lerp=function(t,e,n,a){var r=e[0],o=e[1],i=e[2];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t[2]=i+a*(n[2]-i),t},r.hermite=function(t,e,n,a,r,o){var i=o*o,u=i*(2*o-3)+1,l=i*(o-2)+o,s=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*u+n[0]*l+a[0]*s+r[0]*c,t[1]=e[1]*u+n[1]*l+a[1]*s+r[1]*c,t[2]=e[2]*u+n[2]*l+a[2]*s+r[2]*c,t},r.bezier=function(t,e,n,a,r,o){var i=1-o,u=i*i,l=o*o,s=u*i,c=3*o*u,f=3*l*i,h=l*o;return t[0]=e[0]*s+n[0]*c+a[0]*f+r[0]*h,t[1]=e[1]*s+n[1]*c+a[1]*f+r[1]*h,t[2]=e[2]*s+n[2]*c+a[2]*f+r[2]*h,t},r.random=function(t,e){e=e||1;var n=2*a.RANDOM()*Math.PI,r=2*a.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[3]*a+n[7]*r+n[11]*o+n[15];return i=i||1,t[0]=(n[0]*a+n[4]*r+n[8]*o+n[12])/i,t[1]=(n[1]*a+n[5]*r+n[9]*o+n[13])/i,t[2]=(n[2]*a+n[6]*r+n[10]*o+n[14])/i,t},r.transformMat3=function(t,e,n){var a=e[0],r=e[1],o=e[2];return t[0]=a*n[0]+r*n[3]+o*n[6],t[1]=a*n[1]+r*n[4]+o*n[7],t[2]=a*n[2]+r*n[5]+o*n[8],t},r.transformQuat=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],l=n[2],s=n[3],c=s*a+u*o-l*r,f=s*r+l*a-i*o,h=s*o+i*r-u*a,M=-i*a-u*r-l*o;return t[0]=c*s+M*-i+f*-l-h*-u,t[1]=f*s+M*-u+h*-i-c*-l,t[2]=h*s+M*-l+c*-u-f*-i,t},r.rotateX=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(a)-r[2]*Math.sin(a),o[2]=r[1]*Math.sin(a)+r[2]*Math.cos(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateY=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(a)+r[0]*Math.cos(a),o[1]=r[1],o[2]=r[2]*Math.cos(a)-r[0]*Math.sin(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateZ=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(a)-r[1]*Math.sin(a),o[1]=r[0]*Math.sin(a)+r[1]*Math.cos(a),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,l;for(n||(n=3),a||(a=0),l=r?Math.min(r*n+a,e.length):e.length,u=a;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),r.angle=function(t,e){var n=r.fromValues(t[0],t[1],t[2]),a=r.fromValues(e[0],e[1],e[2]);r.normalize(n,n),r.normalize(a,a);var o=r.dot(n,a);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],u=e[1],l=e[2];return Math.abs(n-i)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-u)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=r},function(t,e,n){var a=n(1),r={};r.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,n,r){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+a*a+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+a*a+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],a=t[2],r=t[3];return Math.sqrt(e*e+n*n+a*a+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],a=t[2],r=t[3];return e*e+n*n+a*a+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*n+a*a+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=n*i,t[1]=a*i,t[2]=r*i,t[3]=o*i),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,n,a){var r=e[0],o=e[1],i=e[2],u=e[3];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t[2]=i+a*(n[2]-i),t[3]=u+a*(n[3]-u),t},r.random=function(t,e){return e=e||1,t[0]=a.RANDOM(),t[1]=a.RANDOM(),t[2]=a.RANDOM(),t[3]=a.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3];return t[0]=n[0]*a+n[4]*r+n[8]*o+n[12]*i,t[1]=n[1]*a+n[5]*r+n[9]*o+n[13]*i,t[2]=n[2]*a+n[6]*r+n[10]*o+n[14]*i,t[3]=n[3]*a+n[7]*r+n[11]*o+n[15]*i,t},r.transformQuat=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],l=n[2],s=n[3],c=s*a+u*o-l*r,f=s*r+l*a-i*o,h=s*o+i*r-u*a,M=-i*a-u*r-l*o;return t[0]=c*s+M*-i+f*-l-h*-u,t[1]=f*s+M*-u+h*-i-c*-l,t[2]=h*s+M*-l+c*-u-f*-i,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,l;for(n||(n=4),a||(a=0),l=r?Math.min(r*n+a,e.length):e.length,u=a;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-s)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},t.exports=r},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=n(4),l=function(t){return t&&t.__esModule?t:{default:t}}(u),s=n(0),c=function(t){function e(t,n){a(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.geometry={positions:new Float32Array(t.positions),indices:new Uint16Array(t.indices),normals:new Float32Array(t.normals||t.positions.length),uvs:new Float32Array(t.uvs||t.positions.length/1.5)},o.material=n,o.material.attributes.a_position.value=o.geometry.positions,o.material.attributes.a_normal.value=o.geometry.normals,o.material.attributes.a_uv.value=o.geometry.uvs,o.material.indices=o.geometry.indices,o}return o(e,t),i(e,[{key:"init",value:function(){this.material.init()}},{key:"bind",value:function(){this.material.bind()}},{key:"update",value:function(){this.material.update(),this.draw()}},{key:"unbind",value:function(){this.material.unbind()}},{key:"draw",value:function(){var t=(0,s.getContext)();t.drawElements(t.TRIANGLES,this.geometry.indices.length,t.UNSIGNED_SHORT,0)}},{key:"destroy",value:function(){this.material.destroy()}}]),e}(l.default);e.default=c},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(3),l=n(6),s=n(7),c=a(s),f=n(5),h=a(f),M=n(9),d=n(18),v=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type=u.BASIC_MATERIAL,n.map=new h.default,t.map&&n.map.fromImage(t.map),Object.assign(n.uniforms,{color:{type:"vec3",value:l.color.convert(t&&t.color||16777215)},map:{type:"sampler2D",value:n.map.texture}}),n.vertex="#version 300 es\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec2 v_uv;\nout vec3 v_normal;\n\nvoid main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0);\n    v_uv = a_uv;\n    v_normal = normalize(mat3(normalMatrix) * a_normal);\n}\n",n.fragment="#version 300 es\n\n#define MAX_DIRECTIONAL "+u.MAX_DIRECTIONAL+"\n\nprecision highp float;\nprecision highp int;\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nstruct Directional {\n    vec4 dlPosition;\n    vec4 dlColor;\n    float flIntensity;\n};\n\nuniform directional {\n    Directional directionalLights[MAX_DIRECTIONAL];\n};\n\nuniform vec3 color;\nuniform sampler2D map;\n\nin vec2 v_uv;\nin vec3 v_normal;\n\nout vec4 outColor;\n\nfloat whenGreaterThan(float x, float y) {\n    return max(sign(x - y), 0.0);\n}\n\nvoid main() {\n    vec4 base = vec4(0.0, 0.0, 0.0, 1.0);\n    base += texture(map, v_uv);\n    base += vec4(color, 1.0);\n    "+(0,d.directional)()+"\n    "+(0,M.linear)()+"\n    outColor = base;\n}",n}return i(e,t),e}(c.default);e.default=v},function(t,e,n){"use strict";function a(t,e,n){return Math.max(Math.min(t,n),e)}function r(t){return 0==(t&t-1)}function o(t,e){return Math.random()*(e-t)+t}Object.defineProperty(e,"__esModule",{value:!0}),e.clamp=a,e.isPowerOf2=r,e.randomRange=o},function(t,e,n){"use strict";function a(){return"\n    for (int i = 0; i < MAX_DIRECTIONAL; i++) {\n        vec3 lightDirection = normalize(directionalLights[i].dlPosition.xyz);\n\n        vec3 light = vec3(dot(v_normal, lightDirection));\n        vec3 directionalColor = directionalLights[i].dlColor.rgb * light;\n        base.rgb += mix(base.rgb, directionalColor, directionalLights[i].flIntensity);\n    }\n    "}Object.defineProperty(e,"__esModule",{value:!0}),e.directional=a},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.loaders=e.helpers=e.utils=e.controls=e.lights=e.geometry=e.material=e.Texture=e.Model=e.Scene=e.cameras=e.Renderer=e.constants=e.session=void 0;var o=n(0),i=r(o),u=n(20),l=a(u),s=n(27),c=r(s),f=n(31),h=a(f),M=n(15),d=a(M),v=n(5),m=a(v),p=n(32),x=r(p),b=n(39),I=r(b),S=n(43),D=r(S),y=n(45),F=r(y),g=n(6),_=r(g),E=n(47),w=r(E),O=n(50),R=r(O),T=n(3),P=r(T);e.session=i,e.constants=P,e.Renderer=l.default,e.cameras=c,e.Scene=h.default,e.Model=d.default,e.Texture=m.default,e.material=x,e.geometry=I,e.lights=D,e.controls=F,e.utils=_,e.helpers=R,e.loaders=w},function(t,e,n){"use strict";(function(t){function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(2),u=n(0),l=n(26),s=function(t){return t&&t.__esModule?t:{default:t}}(l),c=n(3),f=!1,h=void 0,M=void 0,d=i.mat4.create(),v=i.mat4.create(),m=i.mat4.create(),p=Date.now(),x=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.ratio=t.devicePixelRatio,this.fog={start:500,end:1e3,color:i.vec4.fromValues(0,0,0,1),density:.002};var o=n.canvas||this.createCanvas(),l=o.getContext("webgl2",{antialias:!1});if(l){if(!1!==n.greeting){var h,M="color:#f33;font-size:x-small",d=["%c"+u.library+"\n%cversion: %c"+u.version+" %crunning: %c"+l.getParameter(l.VERSION),"color:#666;font-size:x-small;font-weight:bold;","color:#777;font-size:x-small",M,"color:#777;font-size:x-small",M];(h=console).log.apply(h,d)}(0,u.setContext)(l),this.perScene=new s.default([].concat(a(i.mat4.create()),a(i.mat4.create()),a(i.vec4.create()),a(i.vec4.create()),a(i.vec4.create()),a(i.vec4.create()),a(i.vec4.create())),0),this.perModel=new s.default([].concat(a(i.mat4.create()),a(i.mat4.create())),1),this.directional=new s.default(new Float32Array(12*c.MAX_DIRECTIONAL),2),this.frameBuffer=l.createFramebuffer(),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer),this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_NEAREST),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,256,256,0,l.RGBA,l.UNSIGNED_BYTE,null),this.renderBuffer=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,this.renderBuffer),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,256,256),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,this.texture,0),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,this.renderBuffer),l.bindTexture(l.TEXTURE_2D,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null),f=!0}else alert("webgl2 not supported")}return o(e,[{key:"createCanvas",value:function(){var e=document.createElement("canvas");return e.style.display="block",e.style.boxSizing="border-box",e.style.width=t.innerWidth*t.devicePixelRatio,e.style.height=t.innerHeight*t.devicePixelRatio,document.body.appendChild(e),e}},{key:"setSize",value:function(t,e){var n=t*this.ratio,a=e*this.ratio,r=(0,u.getContext)();r.canvas.width=n,r.canvas.height=a,r.canvas.style.width=n/this.ratio+"px",r.canvas.style.height=a/this.ratio+"px"}},{key:"setRatio",value:function(t){this.ratio=t}},{key:"draw",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(f){var r=(0,u.getContext)();r.viewport(0,0,r.canvas.width,r.canvas.height),n&&(r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)),r.enable(r.CULL_FACE),r.enable(r.DEPTH_TEST),e.updateCameraMatrix(r.canvas.width,r.canvas.height),i.mat4.identity(d),i.mat4.lookAt(d,e.position.data,e.target,e.up),i.mat4.identity(v),i.mat4.invert(v,d),t.traverse(),this.perScene.update([].concat(a(e.projectionMatrix),a(d),[this.fog.start,this.fog.end,this.fog.density,0],a(this.fog.color),[t.directional.length,0,0,0],[t.point.length,0,0,0],[(Date.now()-p)/1e3,0,0,0]));for(var o=0;o<t.directional.length;o++)this.directional.update([].concat(a(t.directional[o].position.data),[0]).concat([].concat(a(t.directional[o].color),[0]),[t.directional[o].intensity,0,0,0]),12*o);for(var l=0,s=t.children.length;l<s;l++){if(h=t.children[l],!h.material.program)return void h.init();if(M!==h.material.program){M=h.material.program,r.useProgram(M);var c=r.getUniformBlockIndex(M,"perScene"),x=r.getUniformBlockIndex(M,"perModel"),b=r.getUniformBlockIndex(M,"directional");r.uniformBlockBinding(M,c,this.perScene.boundLocation),r.uniformBlockBinding(M,x,this.perModel.boundLocation),r.uniformBlockBinding(M,b,this.directional.boundLocation),r.bindBufferBase(r.UNIFORM_BUFFER,b,this.directional.buffer)}i.mat4.identity(m),i.mat4.copy(m,v),i.mat4.transpose(m,m),h.bind(),this.perModel.update([].concat(a(h.modelMatrix),a(m))),h.update(),h.unbind(),h=null}}}},{key:"render",value:function(t,e){this.draw(t,e)}},{key:"rtt",value:function(t,e,n,a){var r=(0,u.getContext)();if(n!==this.rttwidth||a!==this.rttheight){var o=n*this.ratio,i=a*this.ratio;r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,o,i,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,this.renderBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,n*this.ratio,a*this.ratio),r.bindRenderbuffer(r.RENDERBUFFER,null),this.rttwidth=n,this.rttheight=a}return r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),this.draw(t,e),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.texture),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,null),this.texture}}]),e}();e.default=x}).call(e,n(11))},function(t,e,n){var a=n(1),r={};r.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,n,r){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.set=function(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t},r.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*o-r*a;return i?(i=1/i,t[0]=o*i,t[1]=-a*i,t[2]=-r*i,t[3]=n*i,t):null},r.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],l=n[1],s=n[2],c=n[3];return t[0]=a*u+o*l,t[1]=r*u+i*l,t[2]=a*s+o*c,t[3]=r*s+i*c,t},r.mul=r.multiply,r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+o*u,t[1]=r*l+i*u,t[2]=a*-u+o*l,t[3]=r*-u+i*l,t},r.scale=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],l=n[1];return t[0]=a*u,t[1]=r*u,t[2]=o*l,t[3]=i*l,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,n,a){return t[2]=a[2]/a[0],n[0]=a[0],n[1]=a[1],n[3]=a[3]-t[2]*n[1],[t,e,n]},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-s)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},t.exports=r},function(t,e,n){var a=n(1),r={};r.create=function(){var t=new a.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,n,r,o,i){var u=new a.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=o,u[5]=i,u},r.set=function(t,e,n,a,r,o,i){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=n*o-a*r;return l?(l=1/l,t[0]=o*l,t[1]=-a*l,t[2]=-r*l,t[3]=n*l,t[4]=(r*u-o*i)*l,t[5]=(a*i-n*u)*l,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1],f=n[2],h=n[3],M=n[4],d=n[5];return t[0]=a*s+o*c,t[1]=r*s+i*c,t[2]=a*f+o*h,t[3]=r*f+i*h,t[4]=a*M+o*d+u,t[5]=r*M+i*d+l,t},r.mul=r.multiply,r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=Math.sin(n),c=Math.cos(n);return t[0]=a*c+o*s,t[1]=r*c+i*s,t[2]=a*-s+o*c,t[3]=r*-s+i*c,t[4]=u,t[5]=l,t},r.scale=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1];return t[0]=a*s,t[1]=r*s,t[2]=o*c,t[3]=i*c,t[4]=u,t[5]=l,t},r.translate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1];return t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=a*s+o*c+u,t[5]=r*s+i*c+l,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=e[0],c=e[1],f=e[2],h=e[3],M=e[4],d=e[5];return Math.abs(n-s)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(u-M)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(l-d)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))},t.exports=r},function(t,e,n){var a=n(1),r={scalar:{},SIMD:{}};r.create=function(){var t=new a.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new a.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,n,r,o,i,u,l,s,c,f,h,M,d,v,m){var p=new a.ARRAY_TYPE(16);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=o,p[5]=i,p[6]=u,p[7]=l,p[8]=s,p[9]=c,p[10]=f,p[11]=h,p[12]=M,p[13]=d,p[14]=v,p[15]=m,p},r.set=function(t,e,n,a,r,o,i,u,l,s,c,f,h,M,d,v,m){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t[9]=c,t[10]=f,t[11]=h,t[12]=M,t[13]=d,t[14]=v,t[15]=m,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.scalar.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],r=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=o,t[11]=e[14],t[12]=r,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.SIMD.transpose=function(t,e){var n,a,r,o,i,u,l,s,c,f;return n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),l=SIMD.Float32x4.shuffle(i,u,0,2,4,6),s=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,s),i=SIMD.Float32x4.shuffle(n,a,2,3,6,7),u=SIMD.Float32x4.shuffle(r,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,u,0,2,4,6),f=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},r.transpose=a.USE_SIMD?r.SIMD.transpose:r.scalar.transpose,r.scalar.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],M=e[11],d=e[12],v=e[13],m=e[14],p=e[15],x=n*u-a*i,b=n*l-r*i,I=n*s-o*i,S=a*l-r*u,D=a*s-o*u,y=r*s-o*l,F=c*v-f*d,g=c*m-h*d,_=c*p-M*d,E=f*m-h*v,w=f*p-M*v,O=h*p-M*m,R=x*O-b*w+I*E+S*_-D*g+y*F;return R?(R=1/R,t[0]=(u*O-l*w+s*E)*R,t[1]=(r*w-a*O-o*E)*R,t[2]=(v*y-m*D+p*S)*R,t[3]=(h*D-f*y-M*S)*R,t[4]=(l*_-i*O-s*g)*R,t[5]=(n*O-r*_+o*g)*R,t[6]=(m*I-d*y-p*b)*R,t[7]=(c*y-h*I+M*b)*R,t[8]=(i*w-u*_+s*F)*R,t[9]=(a*_-n*w-o*F)*R,t[10]=(d*D-v*I+p*x)*R,t[11]=(f*I-c*D-M*x)*R,t[12]=(u*g-i*E-l*F)*R,t[13]=(n*E-a*g+r*F)*R,t[14]=(v*b-d*S-m*x)*R,t[15]=(c*S-f*b+h*x)*R,t):null},r.SIMD.invert=function(t,e){var n,a,r,o,i,u,l,s,c,f,h=SIMD.Float32x4.load(e,0),M=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),v=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(h,M,0,1,4,5),a=SIMD.Float32x4.shuffle(d,v,0,1,4,5),n=SIMD.Float32x4.shuffle(i,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,i,1,3,5,7),i=SIMD.Float32x4.shuffle(h,M,2,3,6,7),o=SIMD.Float32x4.shuffle(d,v,2,3,6,7),r=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.mul(a,i),l=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),u),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(a,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),u),s=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,i)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),i=SIMD.Float32x4.mul(n,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.mul(n,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,i)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),s),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),l),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.mul(n,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),c),f=SIMD.Float32x4.mul(n,u),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),i=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},r.invert=a.USE_SIMD?r.SIMD.invert:r.scalar.invert,r.scalar.adjoint=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],M=e[11],d=e[12],v=e[13],m=e[14],p=e[15];return t[0]=u*(h*p-M*m)-f*(l*p-s*m)+v*(l*M-s*h),t[1]=-(a*(h*p-M*m)-f*(r*p-o*m)+v*(r*M-o*h)),t[2]=a*(l*p-s*m)-u*(r*p-o*m)+v*(r*s-o*l),t[3]=-(a*(l*M-s*h)-u*(r*M-o*h)+f*(r*s-o*l)),t[4]=-(i*(h*p-M*m)-c*(l*p-s*m)+d*(l*M-s*h)),t[5]=n*(h*p-M*m)-c*(r*p-o*m)+d*(r*M-o*h),t[6]=-(n*(l*p-s*m)-i*(r*p-o*m)+d*(r*s-o*l)),t[7]=n*(l*M-s*h)-i*(r*M-o*h)+c*(r*s-o*l),t[8]=i*(f*p-M*v)-c*(u*p-s*v)+d*(u*M-s*f),t[9]=-(n*(f*p-M*v)-c*(a*p-o*v)+d*(a*M-o*f)),t[10]=n*(u*p-s*v)-i*(a*p-o*v)+d*(a*s-o*u),t[11]=-(n*(u*M-s*f)-i*(a*M-o*f)+c*(a*s-o*u)),t[12]=-(i*(f*m-h*v)-c*(u*m-l*v)+d*(u*h-l*f)),t[13]=n*(f*m-h*v)-c*(a*m-r*v)+d*(a*h-r*f),t[14]=-(n*(u*m-l*v)-i*(a*m-r*v)+d*(a*l-r*u)),t[15]=n*(u*h-l*f)-i*(a*h-r*f)+c*(a*l-r*u),t},r.SIMD.adjoint=function(t,e){var n,a,r,o,i,u,l,s,c,f,h,M,d,n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),i=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,a,2,3,6,7),s=SIMD.Float32x4.shuffle(r,o,2,3,6,7),l=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.mul(l,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(u,c),h=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),M=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),M),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),M),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(l,c)),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),M),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,M),SIMD.Float32x4.store(t,12,d),t},r.adjoint=a.USE_SIMD?r.SIMD.adjoint:r.scalar.adjoint,r.determinant=function(t){var e=t[0],n=t[1],a=t[2],r=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8],c=t[9],f=t[10],h=t[11],M=t[12],d=t[13],v=t[14],m=t[15];return(e*i-n*o)*(f*m-h*v)-(e*u-a*o)*(c*m-h*d)+(e*l-r*o)*(c*v-f*d)+(n*u-a*i)*(s*m-h*M)-(n*l-r*i)*(s*v-f*M)+(a*l-r*u)*(s*d-c*M)},r.SIMD.multiply=function(t,e,n){var a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(n,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,0,l);var s=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(n,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,h);var M=SIMD.Float32x4.load(n,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(M,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,d),t},r.scalar.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=e[9],M=e[10],d=e[11],v=e[12],m=e[13],p=e[14],x=e[15],b=n[0],I=n[1],S=n[2],D=n[3];return t[0]=b*a+I*u+S*f+D*v,t[1]=b*r+I*l+S*h+D*m,t[2]=b*o+I*s+S*M+D*p,t[3]=b*i+I*c+S*d+D*x,b=n[4],I=n[5],S=n[6],D=n[7],t[4]=b*a+I*u+S*f+D*v,t[5]=b*r+I*l+S*h+D*m,t[6]=b*o+I*s+S*M+D*p,t[7]=b*i+I*c+S*d+D*x,b=n[8],I=n[9],S=n[10],D=n[11],t[8]=b*a+I*u+S*f+D*v,t[9]=b*r+I*l+S*h+D*m,t[10]=b*o+I*s+S*M+D*p,t[11]=b*i+I*c+S*d+D*x,b=n[12],I=n[13],S=n[14],D=n[15],t[12]=b*a+I*u+S*f+D*v,t[13]=b*r+I*l+S*h+D*m,t[14]=b*o+I*s+S*M+D*p,t[15]=b*i+I*c+S*d+D*x,t},r.multiply=a.USE_SIMD?r.SIMD.multiply:r.scalar.multiply,r.mul=r.multiply,r.scalar.translate=function(t,e,n){var a,r,o,i,u,l,s,c,f,h,M,d,v=n[0],m=n[1],p=n[2];return e===t?(t[12]=e[0]*v+e[4]*m+e[8]*p+e[12],t[13]=e[1]*v+e[5]*m+e[9]*p+e[13],t[14]=e[2]*v+e[6]*m+e[10]*p+e[14],t[15]=e[3]*v+e[7]*m+e[11]*p+e[15]):(a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=e[9],M=e[10],d=e[11],t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=s,t[7]=c,t[8]=f,t[9]=h,t[10]=M,t[11]=d,t[12]=a*v+u*m+f*p+e[12],t[13]=r*v+l*m+h*p+e[13],t[14]=o*v+s*m+M*p+e[14],t[15]=i*v+c*m+d*p+e[15]),t},r.SIMD.translate=function(t,e,n){var a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(u,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var l=SIMD.Float32x4.add(a,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,l),t},r.translate=a.USE_SIMD?r.SIMD.translate:r.scalar.translate,r.scalar.scale=function(t,e,n){var a=n[0],r=n[1],o=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.SIMD.scale=function(t,e,n){var a,r,o,i=SIMD.Float32x4(n[0],n[1],n[2],0);return a=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,0,0,0,0))),r=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.scale=a.USE_SIMD?r.SIMD.scale:r.scalar.scale,r.rotate=function(t,e,n,r){var o,i,u,l,s,c,f,h,M,d,v,m,p,x,b,I,S,D,y,F,g,_,E,w,O=r[0],R=r[1],T=r[2],P=Math.sqrt(O*O+R*R+T*T);return Math.abs(P)<a.EPSILON?null:(P=1/P,O*=P,R*=P,T*=P,o=Math.sin(n),i=Math.cos(n),u=1-i,l=e[0],s=e[1],c=e[2],f=e[3],h=e[4],M=e[5],d=e[6],v=e[7],m=e[8],p=e[9],x=e[10],b=e[11],I=O*O*u+i,S=R*O*u+T*o,D=T*O*u-R*o,y=O*R*u-T*o,F=R*R*u+i,g=T*R*u+O*o,_=O*T*u+R*o,E=R*T*u-O*o,w=T*T*u+i,t[0]=l*I+h*S+m*D,t[1]=s*I+M*S+p*D,t[2]=c*I+d*S+x*D,t[3]=f*I+v*S+b*D,t[4]=l*y+h*F+m*g,t[5]=s*y+M*F+p*g,t[6]=c*y+d*F+x*g,t[7]=f*y+v*F+b*g,t[8]=l*_+h*E+m*w,t[9]=s*_+M*E+p*w,t[10]=c*_+d*E+x*w,t[11]=f*_+v*E+b*w,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.scalar.rotateX=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[4],i=e[5],u=e[6],l=e[7],s=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+s*a,t[5]=i*r+c*a,t[6]=u*r+f*a,t[7]=l*r+h*a,t[8]=s*r-o*a,t[9]=c*r-i*a,t[10]=f*r-u*a,t[11]=h*r-l*a,t},r.SIMD.rotateX=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},r.rotateX=a.USE_SIMD?r.SIMD.rotateX:r.scalar.rotateX,r.scalar.rotateY=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[0],i=e[1],u=e[2],l=e[3],s=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-s*a,t[1]=i*r-c*a,t[2]=u*r-f*a,t[3]=l*r-h*a,t[8]=o*a+s*r,t[9]=i*a+c*r,t[10]=u*a+f*r,t[11]=l*a+h*r,t},r.SIMD.rotateY=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},r.rotateY=a.USE_SIMD?r.SIMD.rotateY:r.scalar.rotateY,r.scalar.rotateZ=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[0],i=e[1],u=e[2],l=e[3],s=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+s*a,t[1]=i*r+c*a,t[2]=u*r+f*a,t[3]=l*r+h*a,t[4]=s*r-o*a,t[5]=c*r-i*a,t[6]=f*r-u*a,t[7]=h*r-l*a,t},r.SIMD.rotateZ=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},r.rotateZ=a.USE_SIMD?r.SIMD.rotateZ:r.scalar.rotateZ,r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,n){var r,o,i,u=n[0],l=n[1],s=n[2],c=Math.sqrt(u*u+l*l+s*s);return Math.abs(c)<a.EPSILON?null:(c=1/c,u*=c,l*=c,s*=c,r=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=u*u*i+o,t[1]=l*u*i+s*r,t[2]=s*u*i-l*r,t[3]=0,t[4]=u*l*i-s*r,t[5]=l*l*i+o,t[6]=s*l*i+u*r,t[7]=0,t[8]=u*s*i+l*r,t[9]=l*s*i-u*r,t[10]=s*s*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=a+a,l=r+r,s=o+o,c=a*u,f=a*l,h=a*s,M=r*l,d=r*s,v=o*s,m=i*u,p=i*l,x=i*s;return t[0]=1-(M+v),t[1]=f+x,t[2]=h-p,t[3]=0,t[4]=f-x,t[5]=1-(c+v),t[6]=d+m,t[7]=0,t[8]=h+p,t[9]=d-m,t[10]=1-(c+M),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getRotation=function(t,e){var n=e[0]+e[5]+e[10],a=0;return n>0?(a=2*Math.sqrt(n+1),t[3]=.25*a,t[0]=(e[6]-e[9])/a,t[1]=(e[8]-e[2])/a,t[2]=(e[1]-e[4])/a):e[0]>e[5]&e[0]>e[10]?(a=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/a,t[0]=.25*a,t[1]=(e[1]+e[4])/a,t[2]=(e[8]+e[2])/a):e[5]>e[10]?(a=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/a,t[0]=(e[1]+e[4])/a,t[1]=.25*a,t[2]=(e[6]+e[9])/a):(a=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/a,t[0]=(e[8]+e[2])/a,t[1]=(e[6]+e[9])/a,t[2]=.25*a),t},r.fromRotationTranslationScale=function(t,e,n,a){var r=e[0],o=e[1],i=e[2],u=e[3],l=r+r,s=o+o,c=i+i,f=r*l,h=r*s,M=r*c,d=o*s,v=o*c,m=i*c,p=u*l,x=u*s,b=u*c,I=a[0],S=a[1],D=a[2];return t[0]=(1-(d+m))*I,t[1]=(h+b)*I,t[2]=(M-x)*I,t[3]=0,t[4]=(h-b)*S,t[5]=(1-(f+m))*S,t[6]=(v+p)*S,t[7]=0,t[8]=(M+x)*D,t[9]=(v-p)*D,t[10]=(1-(f+d))*D,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,n,a,r){var o=e[0],i=e[1],u=e[2],l=e[3],s=o+o,c=i+i,f=u+u,h=o*s,M=o*c,d=o*f,v=i*c,m=i*f,p=u*f,x=l*s,b=l*c,I=l*f,S=a[0],D=a[1],y=a[2],F=r[0],g=r[1],_=r[2];return t[0]=(1-(v+p))*S,t[1]=(M+I)*S,t[2]=(d-b)*S,t[3]=0,t[4]=(M-I)*D,t[5]=(1-(h+p))*D,t[6]=(m+x)*D,t[7]=0,t[8]=(d+b)*y,t[9]=(m-x)*y,t[10]=(1-(h+v))*y,t[11]=0,t[12]=n[0]+F-(t[0]*F+t[4]*g+t[8]*_),t[13]=n[1]+g-(t[1]*F+t[5]*g+t[9]*_),t[14]=n[2]+_-(t[2]*F+t[6]*g+t[10]*_),t[15]=1,t},r.fromQuat=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n+n,u=a+a,l=r+r,s=n*i,c=a*i,f=a*u,h=r*i,M=r*u,d=r*l,v=o*i,m=o*u,p=o*l;return t[0]=1-f-d,t[1]=c+p,t[2]=h-m,t[3]=0,t[4]=c-p,t[5]=1-s-d,t[6]=M+v,t[7]=0,t[8]=h+m,t[9]=M-v,t[10]=1-s-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,n,a,r,o,i){var u=1/(n-e),l=1/(r-a),s=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(r+a)*l,t[10]=(i+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*s,t[15]=0,t},r.perspective=function(t,e,n,a,r){var o=1/Math.tan(e/2),i=1/(a-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+a)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*a*i,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,n,a){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(i+u),s=2/(r+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(i-u)*l*.5,t[9]=(r-o)*s*.5,t[10]=a/(n-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*n/(n-a),t[15]=0,t},r.ortho=function(t,e,n,a,r,o,i){var u=1/(e-n),l=1/(a-r),s=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(r+a)*l,t[14]=(i+o)*s,t[15]=1,t},r.lookAt=function(t,e,n,o){var i,u,l,s,c,f,h,M,d,v,m=e[0],p=e[1],x=e[2],b=o[0],I=o[1],S=o[2],D=n[0],y=n[1],F=n[2];return Math.abs(m-D)<a.EPSILON&&Math.abs(p-y)<a.EPSILON&&Math.abs(x-F)<a.EPSILON?r.identity(t):(h=m-D,M=p-y,d=x-F,v=1/Math.sqrt(h*h+M*M+d*d),h*=v,M*=v,d*=v,i=I*d-S*M,u=S*h-b*d,l=b*M-I*h,v=Math.sqrt(i*i+u*u+l*l),v?(v=1/v,i*=v,u*=v,l*=v):(i=0,u=0,l=0),s=M*l-d*u,c=d*i-h*l,f=h*u-M*i,v=Math.sqrt(s*s+c*c+f*f),v?(v=1/v,s*=v,c*=v,f*=v):(s=0,c=0,f=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=u,t[5]=c,t[6]=M,t[7]=0,t[8]=l,t[9]=f,t[10]=d,t[11]=0,t[12]=-(i*m+u*p+l*x),t[13]=-(s*m+c*p+f*x),t[14]=-(h*m+M*p+d*x),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t[9]=e[9]+n[9]*a,t[10]=e[10]+n[10]*a,t[11]=e[11]+n[11]*a,t[12]=e[12]+n[12]*a,t[13]=e[13]+n[13]*a,t[14]=e[14]+n[14]*a,t[15]=e[15]+n[15]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],h=t[9],M=t[10],d=t[11],v=t[12],m=t[13],p=t[14],x=t[15],b=e[0],I=e[1],S=e[2],D=e[3],y=e[4],F=e[5],g=e[6],_=e[7],E=e[8],w=e[9],O=e[10],R=e[11],T=e[12],P=e[13],A=e[14],L=e[15];return Math.abs(n-b)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-I)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(o-S)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(i-D)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(D))&&Math.abs(u-y)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-F)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(s-g)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-_)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(f-E)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(h-w)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(M-O)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(O))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(v-T)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(m-P)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(p-A)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(x-L)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))},t.exports=r},function(t,e,n){var a=n(1),r=n(12),o=n(13),i=n(14),u={};u.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(a,r,i){var l=o.dot(r,i);return l<-.999999?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,n,r),o.normalize(t,t),u.setAxisAngle(a,t,Math.PI),a):l>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(o.cross(t,r,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+l,u.normalize(a,a))}}(),u.setAxes=function(){var t=r.create();return function(e,n,a,r){return t[0]=a[0],t[3]=a[1],t[6]=a[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=i.clone,u.fromValues=i.fromValues,u.copy=i.copy,u.set=i.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,n){n*=.5;var a=Math.sin(n);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(n),t},u.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),a=Math.sin(n/2);return 0!=a?(t[0]=e[0]/a,t[1]=e[1]/a,t[2]=e[2]/a):(t[0]=1,t[1]=0,t[2]=0),n},u.add=i.add,u.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],l=n[1],s=n[2],c=n[3];return t[0]=a*c+i*u+r*s-o*l,t[1]=r*c+i*l+o*u-a*s,t[2]=o*c+i*s+a*l-r*u,t[3]=i*c-a*u-r*l-o*s,t},u.mul=u.multiply,u.scale=i.scale,u.rotateX=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+i*u,t[1]=r*l+o*u,t[2]=o*l-r*u,t[3]=i*l-a*u,t},u.rotateY=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l-o*u,t[1]=r*l+i*u,t[2]=o*l+a*u,t[3]=i*l-r*u,t},u.rotateZ=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+r*u,t[1]=r*l-a*u,t[2]=o*l+i*u,t[3]=i*l-o*u,t},u.calculateW=function(t,e){var n=e[0],a=e[1],r=e[2];return t[0]=n,t[1]=a,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-a*a-r*r)),t},u.dot=i.dot,u.lerp=i.lerp,u.slerp=function(t,e,n,a){var r,o,i,u,l,s=e[0],c=e[1],f=e[2],h=e[3],M=n[0],d=n[1],v=n[2],m=n[3];return o=s*M+c*d+f*v+h*m,o<0&&(o=-o,M=-M,d=-d,v=-v,m=-m),1-o>1e-6?(r=Math.acos(o),i=Math.sin(r),u=Math.sin((1-a)*r)/i,l=Math.sin(a*r)/i):(u=1-a,l=a),t[0]=u*s+l*M,t[1]=u*c+l*d,t[2]=u*f+l*v,t[3]=u*h+l*m,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(n,a,r,o,i,l){return u.slerp(t,a,i,l),u.slerp(e,r,o,l),u.slerp(n,t,e,2*l*(1-l)),n}}(),u.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*n+a*a+r*r+o*o,u=i?1/i:0;return t[0]=-n*u,t[1]=-a*u,t[2]=-r*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=i.length,u.len=u.length,u.squaredLength=i.squaredLength,u.sqrLen=u.squaredLength,u.normalize=i.normalize,u.fromMat3=function(t,e){var n,a=e[0]+e[4]+e[8];if(a>0)n=Math.sqrt(a+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,i=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*i+i]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+i]-e[3*i+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[i]=(e[3*i+r]+e[3*r+i])*n}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=i.exactEquals,u.equals=i.equals,t.exports=u},function(t,e,n){var a=n(1),r={};r.create=function(){var t=new a.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var n=new a.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,n){return t[0]=e,t[1]=n,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1];return Math.sqrt(n*n+a*a)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1];return n*n+a*a},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=n*n+a*a;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,n){var a=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=a,t},r.lerp=function(t,e,n,a){var r=e[0],o=e[1];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t},r.random=function(t,e){e=e||1;var n=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},r.transformMat2=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r,t[1]=n[1]*a+n[3]*r,t},r.transformMat2d=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r+n[4],t[1]=n[1]*a+n[3]*r+n[5],t},r.transformMat3=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[3]*r+n[6],t[1]=n[1]*a+n[4]*r+n[7],t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[4]*r+n[12],t[1]=n[1]*a+n[5]*r+n[13],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,l;for(n||(n=2),a||(a=0),l=r?Math.min(r*n+a,e.length):e.length,u=a;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var n=t[0],r=t[1],o=e[0],i=e[1];return Math.abs(n-o)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))},t.exports=r},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(0),i=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,t);var r=(0,o.getContext)();this.boundLocation=n,this.data=new Float32Array(e),this.buffer=r.createBuffer(),r.bindBuffer(r.UNIFORM_BUFFER,this.buffer),r.bufferData(r.UNIFORM_BUFFER,this.data,r.DYNAMIC_DRAW),r.bindBuffer(r.UNIFORM_BUFFER,null)}return r(t,[{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,o.getContext)();this.data.set(t,e),n.bindBuffer(n.UNIFORM_BUFFER,this.buffer),n.bufferSubData(n.UNIFORM_BUFFER,0,this.data,0,null),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,this.boundLocation,this.buffer)}}]),t}();e.default=i},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Perspective=e.Orthographic=void 0;var r=n(28),o=a(r),i=n(30),u=a(i);e.Orthographic=o.default,e.Perspective=u.default},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),l=n(2),s=n(4),c=function(t){return t&&t.__esModule?t:{default:t}}(s),f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return Object.assign(n,{near:.1,far:100}),Object.assign(n.position,i({x:0,y:0,z:99},t.position)),n.target=l.vec3.create(),n.up=l.vec3.fromValues(0,1,0),n.projectionMatrix=l.mat4.create(),n}return o(e,t),u(e,[{key:"lookAt",value:function(t){l.vec3.copy(this.target,t)}},{key:"updateCameraMatrix",value:function(t,e){l.mat4.ortho(this.projectionMatrix,-1,1,-1,1,this.near,this.far)}}]),e}(c.default);e.default=f},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(2),i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a(this,t),this.data=o.vec3.fromValues(e,n,r)}return r(t,[{key:"x",set:function(t){o.vec3.set(this.data,t,this.data[1],this.data[2])},get:function(){return this.data[0]}},{key:"y",set:function(t){o.vec3.set(this.data,this.data[0],t,this.data[2])},get:function(){return this.data[1]}},{key:"z",set:function(t){o.vec3.set(this.data,this.data[0],this.data[1],t)},get:function(){return this.data[2]}}]),t}();e.default=i},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),l=n(2),s=n(4),c=function(t){return t&&t.__esModule?t:{default:t}}(s),f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return Object.assign(n,{near:.1,far:1e3,fov:35}),Object.assign(n.position,i({x:0,y:100,z:500},t.position)),n.target=l.vec3.create(),n.up=l.vec3.fromValues(0,1,0),n.projectionMatrix=l.mat4.create(),n}return o(e,t),u(e,[{key:"lookAt",value:function(t){l.vec3.copy(this.target,t)}},{key:"updateCameraMatrix",value:function(t,e){l.mat4.perspective(this.projectionMatrix,this.fov*Math.PI/180,t/e,this.near,this.far)}}]),e}(c.default);e.default=f},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=n(4),l=function(t){return t&&t.__esModule?t:{default:t}}(u),s=n(3),c=function(t){function e(){a(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.ambient=[],t.directional=[],t.point=[],t}return o(e,t),i(e,[{key:"traverse",value:function(t){void 0===t&&(t=this);for(var e=0;e<t.children.length;e+=1)this.traverse(t.children[e]);null!==t.parent&&t.updateMatrices()}},{key:"addLight",value:function(t){switch(t.type){case s.AMBIENT_LIGHT:this.ambient.push(t);break;case s.DIRECTIONAL_LIGHT:this.directional.push(t);break;case s.POINT_LIGHT:this.point.push(t)}}},{key:"removeLight",value:function(t){var e=this.ambient.indexOf(t);-1!==e&&(t.destroy(),this.ambient.splice(e,1)),e=this.directional.indexOf(t),-1!==e&&(t.destroy(),this.directional.splice(e,1)),-1!==(e=this.point.indexOf(t))&&(t.destroy(),this.point.splice(e,1))}}]),e}(l.default);e.default=c},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Raw=e.Sem=e.FlatShading=e.Basic=void 0;var r=n(16),o=a(r),i=n(36),u=a(i),l=n(37),s=a(l),c=n(38),f=a(c);e.Basic=o.default,e.FlatShading=u.default,e.Sem=s.default,e.Raw=f.default},function(t,e,n){"use strict";function a(t){return s.vec3.fromValues(t[0]/255,t[1]/255,t[2]/255)}function r(t){var e=t>>16,n=t>>8&255,a=255&t;return s.vec3.fromValues(e,n,a)}function o(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?s.vec3.fromValues(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):null}function i(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function u(t,e,n){return"#"+i(t)+i(e)+i(n)}function l(t){var e=s.vec3.create(),n="number"==typeof t?r(t):o(t);return s.vec3.copy(e,a(n)),e}Object.defineProperty(e,"__esModule",{value:!0}),e.hexIntToRgb=r,e.hexStringToRgb=o,e.componentToHex=i,e.rgbToHex=u,e.convert=l;var s=n(2)},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(0),i=function(){function t(){a(this,t);var e=(0,o.getContext)();this.vao=e.createVertexArray(),e.bindVertexArray(this.vao)}return r(t,[{key:"bind",value:function(){(0,o.getContext)().bindVertexArray(this.vao)}},{key:"unbind",value:function(){(0,o.getContext)().bindVertexArray(null)}},{key:"destroy",value:function(){(0,o.getContext)().deleteVertexArray(this.vao),this.vao=null}}]),t}();e.default=i},function(t,e,n){"use strict";function a(t,e,n){var a=t.createShader(n);if(t.shaderSource(a,e),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(a);console.error("Error compiling shader",r),t.deleteShader(a)}return a}Object.defineProperty(e,"__esModule",{value:!0});e.createProgram=function(t,e,n){var r=a(t,e,t.VERTEX_SHADER),o=a(t,n,t.FRAGMENT_SHADER),i=t.createProgram();return t.attachShader(i,r),t.attachShader(i,o),t.linkProgram(i),i}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(6),l=n(3),s=n(7),c=a(s),f=n(5),h=a(f),M=n(9),d=n(18),v=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type=l.FLATSHADING_MATERIAL,n.map=new h.default,t.map&&n.map.fromImage(t.map),Object.assign(n.uniforms,{color:{type:"vec3",value:u.color.convert(t&&t.color)},map:{type:"sampler2D",value:n.map.texture}}),n.vertex="#version 300 es\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec3 fragVertexEc;\nout vec2 v_uv;\nout vec3 v_normal;\n\nvoid main() {\n    vec4 position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0);\n    gl_Position = position;\n\n    fragVertexEc = position.xyz;\n    v_uv = a_uv;\n    v_normal = normalize(mat3(normalMatrix) * a_normal);\n}\n        ",n.fragment="#version 300 es\n\n#define MAX_DIRECTIONAL "+l.MAX_DIRECTIONAL+"\n\nprecision highp float;\nprecision highp int;\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nstruct Directional {\n    vec4 dlPosition;\n    vec4 dlColor;\n    float flIntensity;\n};\n\nuniform directional {\n    Directional directionalLights[MAX_DIRECTIONAL];\n};\n\nuniform vec3 color;\nuniform sampler2D map;\n\nin vec3 fragVertexEc;\nin vec2 v_uv;\nin vec3 v_normal;\n\nout vec4 outColor;\n\nvoid main() {\n    vec3 v_normal = normalize(cross(dFdx(fragVertexEc), dFdy(fragVertexEc)));\n\n    vec4 base = vec4(0.0, 0.0, 0.0, 1.0);\n    base += texture(map, v_uv);\n    base += vec4(color, 1.0);\n\n    "+(0,d.directional)()+"\n    "+(0,M.linear)()+"\n\n    outColor = base;\n}\n        ",n}return i(e,t),e}(c.default);e.default=v},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(3),l=n(7),s=a(l),c=n(5),f=a(c),h=n(9),M=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type=u.SEM_MATERIAL,n.map=new f.default,t.map&&n.map.fromImage(t.map),Object.assign(n.uniforms,{map:{type:"sampler2D",value:n.map.texture}}),n.vertex="#version 300 es\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    vec4 position = viewMatrix * modelMatrix * vec4(a_position, 1.0);\n    gl_Position = projectionMatrix * position;\n\n    vec3 v_e = vec3(position);\n    vec3 v_n = mat3(viewMatrix * modelMatrix) * a_normal;\n    vec3 r = reflect(normalize(v_e), normalize(v_n));\n    float m = 2.0 * sqrt(pow(r.x, 2.0) + pow(r.y, 2.0) + pow(r.z + 1.0, 2.0));\n    v_uv = r.xy / m + 0.5;\n}\n        ",n.fragment="#version 300 es\n\n#define MAX_DIRECTIONAL "+u.MAX_DIRECTIONAL+"\n\nprecision highp float;\nprecision highp int;\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nstruct Directional {\n    vec4 dlPosition;\n    vec4 dlColor;\n    float flIntensity;\n};\n\nuniform directional {\n    Directional directionalLights[MAX_DIRECTIONAL];\n};\n\nuniform sampler2D map;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    vec4 base = vec4(0.0, 0.0, 0.0, 1.0);\n    base += texture(map, v_uv);\n    "+(0,h.linear)()+"\n    outColor = base;\n}\n        ",n}return i(e,t),e}(s.default);e.default=M},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),u=n(7),l=function(t){return t&&t.__esModule?t:{default:t}}(u),s=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type=i.RAW_MATERIAL,Object.assign(n.uniforms,t.uniforms),n.vertex=t.vertex||"#version 300 es\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec2 v_uv;\nout vec3 v_normal;\n\nvoid main() {\n    vec4 position = viewMatrix * modelMatrix * vec4(a_position, 1.0);\n    gl_Position = projectionMatrix * position;\n    v_uv = a_uv;\n    v_normal = normalize(mat3(normalMatrix) * a_normal);\n}\n        ",n.fragment=t.fragment||"#version 300 es\n\n#define MAX_DIRECTIONAL "+i.MAX_DIRECTIONAL+"\n\nprecision highp float;\nprecision highp int;\n\nuniform perScene {\n    mat4 projectionMatrix;\n    mat4 viewMatrix;\n    vec4 fogSettings;\n    vec4 fogColor;\n    float currentDirectionalLight;\n    float currentPointLight;\n    float iGlobalTime;\n};\n\nuniform perModel {\n    mat4 modelMatrix;\n    mat4 normalMatrix;\n};\n\nstruct Directional {\n    vec4 dlPosition;\n    vec4 dlColor;\n    float flIntensity;\n};\n\nuniform directional {\n    Directional directionalLights[MAX_DIRECTIONAL];\n};\n\nin vec2 v_uv;\nin vec3 v_normal;\n\nout vec4 outColor;\n\nvoid main() {\n    outColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\n        ",n}return o(e,t),e}(l.default);e.default=s},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=e.Icosahedron=e.Box=void 0;var r=n(40),o=a(r),i=n(41),u=a(i),l=n(42),s=a(l);e.Box=o.default,e.Icosahedron=u.default,e.Plane=s.default},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;a(this,t);for(var o=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],i=0;i<o.length;i+=3)o[i+0]*=e,o[i+1]*=n,o[i+2]*=r;return{positions:o,indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],normals:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],uvs:[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]}};e.default=r},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(8),i=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,t);for(var r=.5+Math.sqrt(5)/2,i=[-1,+r,0,1,+r,0,-1,-r,0,1,-r,0,0,-1,+r,0,1,+r,0,-1,-r,0,1,-r,+r,0,-1,+r,0,1,-r,0,-1,-r,0,1],u=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],l=[],s={faces:(0,o.unflatten)(u,3),positions:(0,o.unflatten)(i,3)},c=Math.min(n,3);c-- >0;)s=this.subdivide(s);for(var f=0;f<s.positions.length;f++){var h=this.normalize(s.positions[f]),M=.5*(-Math.atan2(h[2],-h[0])/Math.PI+1),d=.5+Math.asin(h[1])/Math.PI;l.push([1-M,1-d])}i=s.positions;for(var v=0;v<i.length;v++)this.scale(i[v],e);var m={positions:(0,o.flatten)(s.positions),indices:(0,o.flatten)(s.faces),normals:null,uvs:(0,o.flatten)(l,2)};return m.normals=(0,o.generateVertexNormals)(m.positions,m.indices),m}return r(t,[{key:"fixPoleUVs",value:function(t,e,n){function a(e,a,r,o){var s=n[r],c=n[o];n[a][0]=(s[0]+c[0])/2,l++,i.push(t[a].slice()),u.push(n[a].slice()),e[0]=l}var r=this.firstYIndex(t,1),o=this.firstYIndex(t,-1);if(-1!==r&&-1!==o){for(var i=t.slice(),u=n.slice(),l=i.length-1,s=0;s<e.length;s++){var c=e[s],f=c[0],h=c[1],M=c[2];f===r?a(c,r,h,M):f===o&&a(c,o,h,M)}t=i,n=u}}},{key:"firstYIndex",value:function(t,e){for(var n=0;n<t.length;n++){var a=t[n];if(Math.abs(a[1]-e)<=1e-4)return n}return-1}},{key:"normalize",value:function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n]*t[n];if(0===(e=Math.sqrt(e)))return Array.apply(null,new Array(t.length)).map(Number.prototype.valueOf,0);for(var a=0;a<t.length;a++)t[a]/=e;return t}},{key:"scale",value:function(t,e){for(var n=0;n<t.length;n++)t[n]*=e;return t}},{key:"subdivide",value:function(t){function e(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2,(t[2]+e[2])/2]}function n(t){return t[0].toPrecision(6)+","+t[1].toPrecision(6)+","+t[2].toPrecision(6)}function a(t,a){var r=e(t,a),o=n(r),i=l[o];return i||(l[o]=r,l[o])}for(var r=t.positions,o=t.faces,i=[],u=[],l={},s=0,c=0;c<o.length;c++){var f=o[c],h=f[0],M=f[1],d=f[2],v=r[h],m=r[M],p=r[d],x=a(v,m),b=a(m,p),I=a(p,v),S=u.indexOf(x);-1===S&&(S=s++,u.push(x));var D=u.indexOf(b);-1===D&&(D=s++,u.push(b));var y=u.indexOf(I);-1===y&&(y=s++,u.push(I));var F=u.indexOf(v);-1===F&&(F=s++,u.push(v));var g=u.indexOf(m);-1===g&&(g=s++,u.push(m));var _=u.indexOf(p);-1===_&&(_=s++,u.push(p)),i.push([F,S,y]),i.push([g,D,S]),i.push([_,y,D]),i.push([S,D,y])}return{faces:i,positions:u}}}]),t}();e.default=i},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"XY";a(this,t);for(var u=[],l=[],s=[],c=[],f=0,h=2*e,M=2*n,d=h/r,v=M/o,m=.5*-h,p=.5*-M,x=1/r,b=1/o,I=0;I<o;I+=1)for(var S=0;S<r;S+=1){var D=d*S+m,y=v*I+p,F=S/r,g=I/o;switch(i){case"XZ":u=u.concat([D,0,y]),u=u.concat([D+d,0,y]),u=u.concat([D+d,0,y+v]),u=u.concat([D,0,y+v]),s=s.concat([0,1,0]),s=s.concat([0,1,0]),s=s.concat([0,1,0]),s=s.concat([0,1,0]),c=c.concat([F,1-g]),c=c.concat([F+x,1-g]),c=c.concat([F+x,1-(g+b)]),c=c.concat([F,1-(g+b)]);break;case"YZ":u=u.concat([0,y,D]),u=u.concat([0,y,D+d]),u=u.concat([0,y+v,D+d]),u=u.concat([0,y+v,D]),s=s.concat([1,0,0]),s=s.concat([1,0,0]),s=s.concat([1,0,0]),s=s.concat([1,0,0]),c=c.concat([1-F,g]),c=c.concat([1-(F+x),g]),c=c.concat([1-(F+x),g+b]),c=c.concat([1-F,g+b]);break;default:u=u.concat([D,y,0]),u=u.concat([D+d,y,0]),u=u.concat([D+d,y+v,0]),u=u.concat([D,y+v,0]),s=s.concat([0,0,1]),s=s.concat([0,0,1]),s=s.concat([0,0,1]),s=s.concat([0,0,1]),c=c.concat([F,g]),c=c.concat([F+x,g]),c=c.concat([F+x,g+b]),c=c.concat([F,g+b])}l.push(4*f+0),l.push(4*f+1),l.push(4*f+2),l.push(4*f+0),l.push(4*f+2),l.push(4*f+3),f+=1}return{positions:u,indices:l,normals:s,uvs:c}};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Directional=void 0;var a=n(44),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.Directional=r.default},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=n(4),l=function(t){return t&&t.__esModule?t:{default:t}}(u),s=n(6),c=n(3),f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type=c.DIRECTIONAL_LIGHT,n.guiColor=t&&t.color||16777215,n._color=s.color.convert(n.guiColor),n.intensity=t.intensity||.7,n}return o(e,t),i(e,[{key:"destroy",value:function(){}},{key:"color",set:function(t){this._color=s.color.convert(t)},get:function(){return this._color}}]),e}(l.default);e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Orbit=void 0;var a=n(46),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.Orbit=r.default},function(t,e,n){"use strict";(function(t){function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(2),i=n(17),u=n(0),l=.5*-Math.PI,s=function(){function e(n){var r=this;a(this,e),this.onStart=function(t){t.preventDefault(),r.oy=r.ry,r.ox=r.rx,r._startY=t.pageX/r.width,r._startX=t.pageY/r.height,r.isDown=!0},this.onMove=function(t){if(r.isDown){var e=t.pageX/r.width,n=t.pageY/r.height;r.rx=r.ox+-(r._startX-n)*r.rotationSpeed,r.ry=r.oy+(r._startY-e)*r.rotationSpeed,r.rx=(0,i.clamp)(r.rx,.5*-Math.PI,.5*Math.PI)}},this.onEnd=function(){r.isDown=!1},this.onWheel=function(t){t.preventDefault();var e=0;t.wheelDelta?e=t.wheelDelta:t.detail&&(e=t.detail),r.zoom(-e)};var o=(0,u.getContext)();this.camera=n,this.domElement=o.canvas,this.radius=Math.max(n.position.x,n.position.z),this.rx=Math.atan2(n.position.y,this.radius),this.ry=Math.atan2(n.position.z,n.position.x)+l,this.ox=0,this.oy=0,this.width=t.innerWidth,this.height=t.innerHeight,this.rotationSpeed=5*t.devicePixelRatio,this.zoomMin=.1,this.zoomMax=1/0,this.zoomSpeed=100,this.isDown=!1,this.enable()}return r(e,[{key:"enable",value:function(){this.domElement.addEventListener("mousedown",this.onStart,!1),this.domElement.addEventListener("mousemove",this.onMove,!1),this.domElement.addEventListener("mouseup",this.onEnd,!1),this.domElement.addEventListener("touchstart",this.onStart,!1),this.domElement.addEventListener("touchmove",this.onMove,!1),this.domElement.addEventListener("touchend",this.onEnd,!1),t.addEventListener("mousewheel",this.onWheel,!1)}},{key:"disable",value:function(){this.domElement.removeEventListener("mousedown",this.onStart,!1),this.domElement.removeEventListener("mousemove",this.onMove,!1),this.domElement.removeEventListener("mouseup",this.onEnd,!1),this.domElement.removeEventListener("touchstart",this.onStart,!1),this.domElement.removeEventListener("touchmove",this.onMove,!1),this.domElement.removeEventListener("touchend",this.onEnd,!1),t.removeEventListener("mousewheel",this.onWheel,!1)}},{key:"zoom",value:function(t){this.radius+=t/1e3*this.zoomSpeed,this.radius=(0,i.clamp)(this.radius,this.zoomMin,this.zoomMax)}},{key:"update",value:function(){var t=this.radius*Math.sin(this.rx),e=this.radius*Math.cos(this.rx),n=Math.sin(this.ry)*e,a=Math.cos(this.ry)*e;o.vec3.set(this.camera.position.data,n,t,a)}}]),e}();e.default=s}).call(e,n(11))},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Json=e.Obj=e.File=void 0;var r=n(10),o=a(r),i=n(48),u=a(i),l=n(49),s=a(l);e.File=o.default,e.Obj=u.default,e.Json=s.default},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(10),i=function(t){return t&&t.__esModule?t:{default:t}}(o),u=function(){function t(){a(this,t)}return r(t,null,[{key:"load",value:function(e,n){i.default.load(e).then(function(e){n(t.parse(e))})}},{key:"parse",value:function(t){var e=[],n=[],a=[],r={};r.verts=[],r.norms=[],r.textures=[],r.hashindices={},r.indices=[],r.index=0;for(var o=t.split("\n"),i=/^v\s/,u=/^vn\s/,l=/^vt\s/,s=/^f\s/,c=/\s+/,f=0;f<o.length;f++){var h=o[f].trim(),M=h.split(c);if(M.shift(),i.test(h))e.push.apply(e,M);else if(u.test(h))n.push.apply(n,M);else if(l.test(h))a.push.apply(a,M);else if(s.test(h))for(var d=!1,v=0;v<M.length;v++){if(3!==v||d||(v=2,d=!0),M[v]in r.hashindices)r.indices.push(r.hashindices[M[v]]);else{var m=M[v].split("/");r.verts.push(+e[3*(m[0]-1)+0]),r.verts.push(+e[3*(m[0]-1)+1]),r.verts.push(+e[3*(m[0]-1)+2]),a.length&&(r.textures.push(+a[2*(m[1]-1)+0]),r.textures.push(+a[2*(m[1]-1)+1])),r.norms.push(+n[3*(m[2]-1)+0]),r.norms.push(+n[3*(m[2]-1)+1]),r.norms.push(+n[3*(m[2]-1)+2]),r.hashindices[M[v]]=r.index,r.indices.push(r.index),r.index+=1}3===v&&d&&r.indices.push(r.hashindices[M[0]])}}return{positions:r.verts,indices:r.indices,normals:r.norms,uvs:r.textures}}}]),t}();e.default=u},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(10),i=function(t){return t&&t.__esModule?t:{default:t}}(o),u=n(8),l=function(){function t(){a(this,t)}return r(t,null,[{key:"load",value:function(e,n){i.default.load(e).then(function(e){n(t.parse(e))})}},{key:"parse",value:function(t){var e=JSON.parse(t);return void 0===e.normals&&(e.normals=(0,u.generateVertexNormals)(e.positions,e.indices)),{positions:e.positions,indices:e.indices,normals:e.normals}}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Normal=void 0;var a=n(51),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.Normal=r.default},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),l=n(15),s=a(l),c=n(16),f=a(c),h=n(0),M=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16777215;r(this,e);for(var i={positions:[]},u=t.scale.x,l=t.scale.y,s=t.scale.z,c=t.geometry.normals.length/3,h=0;h<c;h+=1){var M=3*h,d=u*t.geometry.positions[M+0],v=l*t.geometry.positions[M+1],m=s*t.geometry.positions[M+2],p=t.geometry.normals[M+0],x=t.geometry.normals[M+1],b=t.geometry.normals[M+2],I=d+n*p,S=v+n*x,D=m+n*b;i.positions=i.positions.concat([d,v,m,I,S,D])}var y=new f.default({color:a});return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i,y))}return i(e,t),u(e,[{key:"draw",value:function(){var t=(0,h.getContext)();t.drawArrays(t.LINES,0,this.geometry.positions.length/3)}}]),e}(s.default);e.default=M}])});